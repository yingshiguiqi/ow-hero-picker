# 守望先锋地图英雄推荐系统

一个帮助玩家为不同守望先锋地图选择合适英雄的Web应用。支持手动选择和智能导入两种模式，可以快速为每张地图配置英雄评级。

## 功能特点

### 📍 双模式操作
- **手动选择模式**: 直接在界面上选择英雄并评级
- **导入模式**: 支持图片OCR识别和文本识别导入英雄

### 🗺️ 完整地图支持
- 抢点图（7张）
- 机动推进图（4张）
- 闪点图（3张）
- 纯推车图（8张）
- 混合推车图（7张）

### 🦸 英雄管理
- 按职责分类：坦克、输出、支援
- 三级评级：不错哦、一般般、不好用
- **网格布局**：每个评级列网格展示，每行5个英雄，一目了然
- 快捷操作：一键分配剩余英雄、批量设置评级
- **完整英雄头像**: 所有44个英雄均有官方头像（包含最新的骇灾、芙蕾雅、无漾）
- 24个PNG格式 + 20个WebP格式，全部本地化存储

### 💾 预设系统
- **智能加载**：加载预设时自动切换到对应地图
- 保存/加载预设配置
- 导入/导出JSON配置文件
- 导出为图片分享

## 🚀 快速开始

### 方式1：云端部署（推荐，免费）

**一键部署到Vercel（5分钟）：**

[![Deploy with Vercel](https://vercel.com/button)](https://vercel.com/new/clone?repository-url=https://github.com/你的用户名/ow-hero-picker)

1. 点击上方按钮
2. 连接GitHub账号
3. 等待自动部署
4. 获得免费域名：`你的项目.vercel.app`

**详细部署指南：** 见 [DEPLOY.md](./DEPLOY.md)

### 方式2：本地运行

#### 环境要求
- Node.js 16.0+
- npm 或 yarn

#### 安装步骤

1. 克隆项目
```bash
git clone [项目地址]
cd ow
```

2. 安装依赖
```bash
npm install
```

3. 运行开发服务器
```bash
npm run dev
```

4. 打开浏览器访问
```
http://localhost:3000
```

### 构建部署

```bash
npm run build
npm start
```

## 使用指南

### 手动选择模式

1. **选择地图**: 在左侧栏选择要配置的地图
2. **选择评级**: 点击上方评级按钮（不错哦/一般般/不好用）
3. **点击英雄**: 点击英雄卡片为其设置评级
4. **快捷操作**: 使用"一键将剩余英雄设为不好用"快速完成配置

### 导入模式

1. **切换到导入模式**: 点击顶部"导入模式"按钮
2. **导入英雄**:
   - 图片识别：上传包含英雄头像的截图
   - 文本识别：输入英雄名称文本
3. **配置评级**: 导入成功后选择地图并配置评级

### 预设管理

- **保存预设**: 配置完成后点击"保存预设"并命名
- **加载预设**: 从列表中选择并加载已保存的预设（自动切换到对应地图）
- **导出配置**: 导出为JSON文件或图片
- **导入配置**: 导入之前导出的JSON配置文件

## 技术栈

- **框架**: Next.js 14 + React 18
- **语言**: TypeScript
- **样式**: Tailwind CSS
- **状态管理**: Zustand
- **图标**: Lucide React
- **工具库**:
  - html2canvas (图片导出)
  - tesseract.js (OCR识别)

## 项目结构

```
ow/
├── app/                # Next.js 应用目录
│   ├── page.tsx       # 主页面
│   ├── layout.tsx     # 布局
│   └── globals.css    # 全局样式
├── components/        # React 组件
│   ├── HeroCard.tsx   # 英雄卡片
│   ├── HeroGrid.tsx   # 英雄网格
│   ├── MapSelector.tsx # 地图选择器
│   ├── ImportMode.tsx # 导入模式
│   └── PresetManager.tsx # 预设管理
├── data/              # 数据配置
│   ├── heroes.ts      # 英雄数据
│   └── maps.ts        # 地图数据
├── store/             # 状态管理
│   └── useStore.ts    # Zustand store
├── utils/             # 工具函数
│   ├── heroRecognition.ts # 英雄识别
│   └── exportToImage.ts   # 图片导出
└── lib/               # 库函数
    └── utils.ts       # 通用工具

```

## 浏览器支持

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 常见问题

### 如果遇到 "Map is not a constructor" 错误
这是由于类型命名冲突导致的。解决方案：
1. 删除 `.next` 文件夹：`Remove-Item -Recurse -Force .next`
2. 重新启动开发服务器：`npm run dev`

### 如果图片识别功能缓慢
OCR识别需要下载语言包，首次使用可能较慢，后续会自动缓存。

## 开发计划

- [x] 添加更多英雄头像显示
- [x] 支持本地下载和缓存英雄头像
- [ ] 支持团队阵容推荐
- [ ] 添加地图攻防端区分
- [ ] 支持多语言
- [ ] 添加英雄克制关系展示
- [ ] 云端同步功能
- [ ] 添加英雄详细信息展示

## 更新日志

### v3.0.0 (2024-12-09) - 拖拽系统+统计看板 🎯📊
- ✅ **拖拽交互系统（dnd-kit）**：
  - 拖拽模式/点击模式一键切换
  - 抓取英雄拖到目标区域
  - 拖拽预览（旋转+缩放效果）
  - Whoosh音效+Success完成音效
  - 8px激活距离防误触
  - cursor-grab/grabbing视觉反馈
- ✅ **统计看板（Recharts）**：
  - 英雄登场率Top 10（柱状图）
  - 职责偏好分布（饼图）
  - 4个概览卡片（预设数/推荐数/备选数/最常用）
  - 自动分析LocalStorage数据
  - 实时响应式图表
  - 无数据友好提示
- ✅ **交互优化**：
  - Header新增"页面"Tab（配置/统计）
  - 紫色统计主题色
  - 拖拽区域Hover高亮+Ring效果
  - "松开以添加"弹跳提示
  - 自定义Tooltip样式

### v2.9.0 (2024-12-09) - 专业级优化（锐评响应）🚀
- ✅ **OCR最后一公里**：
  - 全局Ctrl+V粘贴剪贴板图片
  - 截图后直接粘贴，无需保存文件
  - Pop音效+绿色动画提示
  - 消除"保存文件"的罪过
- ✅ **Zod运行时验证**：
  - 分享码加载前Zod Schema验证
  - 脏数据自动清洗（不存在的英雄ID自动移除）
  - 旧版本配置兼容新版本
  - 防御性编程，优雅降级
- ✅ **自定义Combo系统**（基础设施）：
  - HeroCombo接口支持custom标记
  - loadCustomCombos/saveCustomCombos
  - createCustomCombo工厂函数
  - LocalStorage持久化
  - 下一步：UI面板

### v2.8.0 (2024-12-09) - 音效系统+Combo提示 🔊💫
- ✅ **完整音效系统**：
  - Web Audio API生成5种音效（click/success/error/whoosh/pop）
  - 点击英雄：click音效
  - 成功操作：success音效（保存/复制/加载）
  - 错误操作：error音效（加载失败）
  - 音效开关：右下角浮动按钮，状态持久化
- ✅ **Combo提示系统**：
  - 15种经典英雄羁绊（天地组合、重力龙、纳米龙刃等）
  - 金色边框高亮有配合的英雄
  - 实时计算配合关系
  - 智能推荐最佳搭配
- ✅ **音效类型**：
  - click：轻点击（800Hz方波，50ms）
  - success：上升音（400→800Hz正弦波，150ms）
  - error：下降音（300→150Hz锯齿波，200ms）
  - whoosh：滑动音（1000→200Hz扫频，120ms）
  - pop：弹出音（200Hz正弦波，80ms）

### v2.7.0 (2024-12-09) - 分享代码+动画增强 🔗✨
- ✅ **分享码生成**：一键生成短代码（Base64编码），包含地图和所有英雄评级
- ✅ **分享码加载**：粘贴队友分享的代码，自动恢复完整阵容
- ✅ **便捷UI**：对话框式操作，一键复制，成功反馈
- ✅ **跨平台分享**：代码可通过Discord/微信/QQ等任意渠道传输
- ✅ **动画增强**：
  - 弹跳进入动画（bounceIn）
  - 旋转淡入动画（rotateIn）
  - 悬停脉冲发光效果
  - 所有对话框缩放淡入
- ✅ **快捷键面板**：右下角浮动按钮，显示所有快捷键，Mac/Windows自适应提示

### v2.6.0 (2024-12-09) - 撤销/重做+移动端适配 📱
- ✅ **撤销/重做系统**：Ctrl+Z撤销，Ctrl+Y/Ctrl+Shift+Z重做，最多50条历史记录
- ✅ **键盘快捷键**：全局监听，支持Mac（Cmd+Z/Cmd+Shift+Z）
- ✅ **历史管理**：每次评级操作自动保存，智能截断重做栈
- ✅ **移动端响应式**：
  - 侧边栏：全屏抽屉式，带遮罩层，滑入动画
  - 英雄网格：手机4列，平板5-6列，桌面8列
  - 控制栏：移动端垂直布局，桌面端水平布局
  - 主内容区：移动端全宽，桌面端自动偏移
- ✅ **触摸优化**：按钮大小适配手指点击，间距优化
- 📋 **待实现**：FLIP动画、音效系统、Combo提示、分享代码

### v2.5.0 (2024-12-09) - 功能深化 🚀
- ✅ **预设重命名**：双击标题或点击编辑图标内联重命名，Enter保存/Esc取消
- ✅ **文本导出**：复制文本按钮，带绿色成功反馈，格式化输出（✅推荐/⚡备选/❌不推荐）
- ✅ **过渡动画**：全局150ms过渡，已评级区域滑入动画，按钮hover平滑效果
- ✅ **内联编辑**：预设名称直接编辑，自动聚焦，失焦自动保存

### v2.4.0 (2024-12-09) - 心理模型优化 🧠
- ✅ **预设列表优化**：增加间距、操作图标hover显示、统一橙色主题
- ✅ **警告语言**：不推荐英雄改用红色主题+警告圆点，传达"Warning"而非"Disabled"
- ✅ **分段控件**：模式切换改为Segmented Control样式，降低视觉权重
- ✅ **心理模型正确**：红色=警告可恢复，灰色=禁用不可用，橙色=当前状态

### v2.3.0 (2024-12-09) - 像素级完美优化 🔍
- ✅ **终极滚动条**：6px深灰色细滚动条，侧边栏专用样式，支持Firefox
- ✅ **增强幽灵按钮**：添加淡背景色、加粗字体、hover阴影，增加实心感
- ✅ **不推荐英雄优化**：提高亮度+对比度，添加红色斜杠遮罩，清晰可辨
- ✅ **精确对齐**：控制栏按钮统一h-10高度，地图列表左边距精确对齐
- ✅ **智能光标**：推荐/备选=crosshair，不推荐=not-allowed，已评级=pointer
- ✅ **ring预览**：悬停时显示彩色ring边框，视觉反馈更强

### v2.2.0 (2024-12-09) - 克制美学优化 🎨
- ✅ **去除补丁感文字**：移除"当前工具"和说明文字，用视觉反馈代替
- ✅ **幽灵按钮设计**：侧边栏预设管理改为低调的边框按钮，统一橙色hover
- ✅ **统一颜色系统**：地图类型仅在展开时显示橙色，避免"红绿灯"效果
- ✅ **加强结果区**：已评级英雄升级至20x20，更强发光、阴影和边框
- ✅ **克制的装饰**：精简分隔栏，降低视觉噪音
- ✅ **3色原则**：整体颜色控制在橙/蓝/灰三色以内

### v2.1.0 (2024-12-09) - UX重大优化 🎯
- ✅ **明确交互隐喻**：画笔光标(cursor-crosshair) + 悬停预览边框
- ✅ **加强结果展示**：已评级英雄卡片升级至16x16，显示名称，发光效果，彩色背景条
- ✅ **智能去色方案**：不推荐英雄保留30%饱和度，悬停恢复全彩，解决辨识度问题
- ✅ **优化视觉层级**：结果区视觉权重大幅提升，清晰传达"这把该玩谁"
- ✅ **精美分隔设计**：装饰性渐变分隔线 + 居中标题卡，消除空白断层感

### v2.0.0 (2024-12-09) - 守望先锋风格重构 🎮
- ✅ **革命性UI重构**：完全重新设计，符合守望先锋游戏风格
- ✅ **倒转布局**：主区域展示英雄选择池（8列大图标），已评级英雄横向紧凑展示在顶部
- ✅ **一屏操作**：无需滚动，所有内容一目了然，屏效提升300%
- ✅ **守望先锋视觉**：橙蓝配色、斜角按钮设计、渐变效果、未来感字体
- ✅ **优化文案**：统一uppercase风格，"推荐/备选/不推荐"替代口语化表达
- ✅ **自定义滚动条**：橙色渐变滚动条，完全匹配游戏风格
- ✅ **紧凑头部**：地图信息集成到顶部栏，节省空间
- ✅ **高级英雄卡片**：渐变遮罩、悬停缩放、图层效果
- ✅ **控制栏优化**：单行紧凑布局，斜角clip-path按钮

### v1.4.0 (2024-12-09)
- ✅ **优化UI布局**：三个评级列改为网格布局，每行显示5个英雄
- ✅ **改进侧边栏控制**：全新的侧边栏开关按钮设计，更加美观
- ✅ **修复预设加载**：加载预设时自动切换到对应地图
- ✅ **响应式英雄卡片**：优化卡片尺寸以适应新布局
- ✅ **渐变色按钮**：侧边栏打开按钮使用蓝紫渐变效果

### v1.3.0 (2024-12-09)
- ✅ **所有44个英雄头像完整集成！**
- ✅ 新增20个WebP格式头像（毛加、莱因哈特、西格玛、破坏球、查莉娅、骇灾等）
- ✅ 支持PNG和WebP双格式
- ✅ 所有头像本地化存储，无需依赖外部CDN
- ✅ 完美支持最新英雄：骇灾、芙蕾雅、无漾

### v1.2.0 (2024-12-09)
- ✅ 新增3个英雄：骇灾（坦克）、芙蕾雅（输出）、无漾（支援）
- ✅ 英雄总数从41增至44个
- ✅ 24个英雄头像本地化（已下载到 public/heroes/）
- ✅ 修复CDN 403错误，未下载成功的英雄使用降级显示
- ✅ 优化头像加载性能

### v1.1.0 (2024-12-09)
- ✅ 添加所有英雄的官方头像
- ✅ 头像使用守望先锋官方CDN
- ✅ 支持头像加载失败时的降级显示
- ✅ 优化英雄卡片视觉效果

### v1.0.0 (2024-12-09)
- ✅ 初始版本发布
- ✅ 实现双模式操作（手动选择/导入模式）
- ✅ 完整的地图和英雄数据
- ✅ 三级评级系统
- ✅ 预设管理功能
- ✅ 导出功能（JSON配置/图片）
- ✅ 修复类型命名冲突问题

## 许可证

MIT License
